(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     14415,        428]
NotebookOptionsPosition[     11909,        375]
NotebookOutlinePosition[     12252,        390]
CellTagsIndexPosition[     12209,        387]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"$Assumptions", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Element", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"WD", ",", "PD", ",", "f1", ",", "f0", ",", "f2"}], "}"}], ",",
       "Reals"}], "]"}], ",", 
    RowBox[{"WD", ">", "0"}], ",", 
    RowBox[{"PD", ">", "0"}], ",", 
    RowBox[{"f0", ">", "0"}], ",", 
    RowBox[{"f1", ">", "0"}], ",", 
    RowBox[{"f2", ">", "0"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.8231479733652735`*^9, 3.823148002035242*^9}, {
  3.823148165173071*^9, 3.8231481856030416`*^9}, {3.8231501440737*^9, 
  3.823150146512686*^9}, {3.823150676497053*^9, 3.823150691120037*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"644e0d9c-86c1-463b-a854-c518c636d247"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"WD", "|", "PD", "|", "f1", "|", "f0", "|", "f2"}], ")"}], 
    "\[Element]", 
    TemplateBox[{},
     "Reals"]}], ",", 
   RowBox[{"WD", ">", "0"}], ",", 
   RowBox[{"PD", ">", "0"}], ",", 
   RowBox[{"f0", ">", "0"}], ",", 
   RowBox[{"f1", ">", "0"}], ",", 
   RowBox[{"f2", ">", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.823147996755109*^9, 3.8231480022922316`*^9}, {
   3.8231481722410326`*^9, 3.823148186268978*^9}, 3.8231501467806697`*^9, 
   3.8231506913898106`*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"b0d78fbe-d5f6-44c1-b100-11bc572bbaf2"]
}, Open  ]],

Cell["Matrices for optics", "Text",
 CellChangeTimes->{{3.823148031301753*^9, 
  3.8231480585781703`*^9}},ExpressionUUID->"1772b5f9-7ec9-4956-af1f-\
64f679bac75d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lens2", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "/", "f2"}], ",", "1"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.8231476145011177`*^9, 3.823147667924891*^9}, {
  3.823147811772478*^9, 3.823147814563651*^9}, {3.8231505024699593`*^9, 
  3.823150503592185*^9}, {3.8231511348095074`*^9, 3.8231511349033575`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"735bec5a-f9da-46ec-990e-7b2190e86d8a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "f2"]}], ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8231511355203476`*^9, 3.8231511510913553`*^9}},
 CellLabel->"Out[19]=",ExpressionUUID->"53fe76c1-b9a0-427f-a560-9ccdb597efb7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tube", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"PD", "-", "WD"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.8231476606526475`*^9, 3.8231476667090845`*^9}, {
  3.823147954821296*^9, 3.8231479612832904`*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"ce8a9d8a-8ae7-44b3-8c57-70b19291b225"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"PD", "-", "WD"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.823147662823639*^9, 3.8231478299304333`*^9, 
  3.823147967899269*^9, 3.823150518295736*^9, 3.823151153507308*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"eaac920d-c276-47ee-8db2-8e5c9ec8f1e1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lens1", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "/", "f1"}], ",", "1"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.8231476701006365`*^9, 3.8231476811396236`*^9}, {
  3.8231478173724613`*^9, 3.8231478203236494`*^9}, {3.823150508633253*^9, 
  3.8231505103204346`*^9}, {3.82315115779348*^9, 3.823151157895481*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"b69faa23-3725-4b4e-95e9-78aa60cb9f47"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "f1"]}], ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.823147689824602*^9, {3.8231478205574465`*^9, 3.823147831872774*^9}, 
   3.823150510861235*^9, 3.823151158316468*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"4b54e3b6-801c-4f3c-9d18-68a760cadfee"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"propagationAir", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"WD", "/", "2"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.82314769309256*^9, 3.823147713859585*^9}, {
  3.823154294068743*^9, 3.8231543169237175`*^9}, {3.8231544253075876`*^9, 
  3.823154431443581*^9}, {3.823154563445422*^9, 3.8231545665313025`*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"55cb37d2-7e47-4c96-a014-1f62b80a9995"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["WD", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8231477142631693`*^9, {3.82314782263844*^9, 3.8231478334594193`*^9}, 
   3.8231505164682336`*^9, 3.823151161124338*^9, 3.823154431924158*^9, 
   3.823154570787364*^9},
 CellLabel->"Out[50]=",ExpressionUUID->"ca3beaf0-cf21-41ab-94e8-9300c9afc339"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"refractionAirToGlass", " ", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"1", "/", "n"}]}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.8231513512652493`*^9, 3.8231513543862443`*^9}, {
  3.8231544408605804`*^9, 3.823154488188511*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"12343c8d-8ca3-4dbc-9670-63ffd6f2de73"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["1", "n"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.823154488944892*^9},
 CellLabel->"Out[47]=",ExpressionUUID->"2ccb80b5-c250-45da-b2eb-499815a773f2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"propagationGlass", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "d"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.8231544911735077`*^9, 3.823154510124486*^9}, {
  3.8231547480452023`*^9, 3.8231547481632037`*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"3b7bf8a6-2d07-43d3-8ce3-020d9cebb640"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "d"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8231545112044983`*^9, 3.8231547485221844`*^9},
 CellLabel->"Out[51]=",ExpressionUUID->"fbb9ffc4-36f3-4cff-9990-231ee25140b9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"refractionGlassToAir", " ", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "n"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.8231545158134785`*^9, 3.823154538028453*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"d94c2fd3-d5be-4d76-9cf3-41462615242b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "n"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8231545384534245`*^9},
 CellLabel->"Out[49]=",ExpressionUUID->"2492119a-1042-4e69-aff3-4aa31bd0a7c8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"matrix", " ", "=", " ", 
  RowBox[{
   RowBox[{
   "lens2", ".", "tube", ".", "lens1", ".", "propagationAir", ".", 
    "refractionAirToGlass", ".", "propagationGlass", ".", 
    "refractionGlassToAir", ".", "propagationAir"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.8231545406773186`*^9, 3.823154573371411*^9}, {
  3.823154728931226*^9, 3.8231547712701373`*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"736ce504-b69e-491c-a4ce-ac9914711eeb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"f1", "-", "PD", "+", "WD"}], "f1"], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"f1", " ", "PD"}], "+", 
       RowBox[{"WD", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "PD"}], "+", "WD"}], ")"}]}], "+", 
       RowBox[{"d", " ", "n", " ", 
        RowBox[{"(", 
         RowBox[{"f1", "-", "PD", "+", "WD"}], ")"}]}]}], "f1"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"f1", "+", "f2", "-", "PD", "+", "WD"}], 
       RowBox[{"f1", " ", "f2"}]]}], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"f1", " ", 
        RowBox[{"(", 
         RowBox[{"f2", "-", 
          RowBox[{"d", " ", "n"}], "-", "PD"}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", "n"}], "+", "WD"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"f2", "-", "PD", "+", "WD"}], ")"}]}]}], 
      RowBox[{"f1", " ", "f2"}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.823154771585637*^9},
 CellLabel->"Out[52]=",ExpressionUUID->"21c7eee9-3464-4c8e-a480-fd8d80e33d7c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "matrix", "]"}]], "Input",
 CellChangeTimes->{{3.823154776453168*^9, 3.8231547818031635`*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"e3547a66-2f34-4bfc-b0fa-246be2cb5bb0"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{"f1", "-", "PD", "+", "WD"}], "f1"], 
      FractionBox[
       RowBox[{
        RowBox[{"f1", " ", "PD"}], "+", 
        RowBox[{"WD", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "PD"}], "+", "WD"}], ")"}]}], "+", 
        RowBox[{"d", " ", "n", " ", 
         RowBox[{"(", 
          RowBox[{"f1", "-", "PD", "+", "WD"}], ")"}]}]}], "f1"]},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"f1", "+", "f2", "-", "PD", "+", "WD"}], 
        RowBox[{"f1", " ", "f2"}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"f1", " ", 
         RowBox[{"(", 
          RowBox[{"f2", "-", 
           RowBox[{"d", " ", "n"}], "-", "PD"}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d", " ", "n"}], "+", "WD"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"f2", "-", "PD", "+", "WD"}], ")"}]}]}], 
       RowBox[{"f1", " ", "f2"}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.823154782035324*^9},
 CellLabel->
  "Out[53]//MatrixForm=",ExpressionUUID->"e90052a1-3801-494e-b98e-\
fdd5c74ae45a"]
}, Open  ]]
},
WindowSize->{760, 833},
WindowMargins->{{Automatic, 878}, {14, Automatic}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 731, 17, 28, "Input",ExpressionUUID->"644e0d9c-86c1-463b-a854-c518c636d247"],
Cell[1314, 41, 644, 17, 34, "Output",ExpressionUUID->"b0d78fbe-d5f6-44c1-b100-11bc572bbaf2"]
}, Open  ]],
Cell[1973, 61, 163, 3, 34, "Text",ExpressionUUID->"1772b5f9-7ec9-4956-af1f-64f679bac75d"],
Cell[CellGroupData[{
Cell[2161, 68, 550, 13, 28, "Input",ExpressionUUID->"735bec5a-f9da-46ec-990e-7b2190e86d8a"],
Cell[2714, 83, 367, 10, 49, "Output",ExpressionUUID->"53fe76c1-b9a0-427f-a560-9ccdb597efb7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3118, 98, 440, 11, 28, "Input",ExpressionUUID->"ce8a9d8a-8ae7-44b3-8c57-70b19291b225"],
Cell[3561, 111, 413, 10, 32, "Output",ExpressionUUID->"eaac920d-c276-47ee-8db2-8e5c9ec8f1e1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4011, 126, 551, 13, 28, "Input",ExpressionUUID->"b69faa23-3725-4b4e-95e9-78aa60cb9f47"],
Cell[4565, 141, 438, 12, 49, "Output",ExpressionUUID->"4b54e3b6-801c-4f3c-9d18-68a760cadfee"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5040, 158, 543, 12, 28, "Input",ExpressionUUID->"55cb37d2-7e47-4c96-a014-1f62b80a9995"],
Cell[5586, 172, 467, 12, 49, "Output",ExpressionUUID->"ca3beaf0-cf21-41ab-94e8-9300c9afc339"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6090, 189, 449, 11, 28, "Input",ExpressionUUID->"12343c8d-8ca3-4dbc-9670-63ffd6f2de73"],
Cell[6542, 202, 316, 9, 49, "Output",ExpressionUUID->"2ccb80b5-c250-45da-b2eb-499815a773f2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6895, 216, 423, 10, 28, "Input",ExpressionUUID->"3b7bf8a6-2d07-43d3-8ce3-020d9cebb640"],
Cell[7321, 228, 318, 8, 32, "Output",ExpressionUUID->"fbb9ffc4-36f3-4cff-9990-231ee25140b9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7676, 241, 369, 9, 28, "Input",ExpressionUUID->"d94c2fd3-d5be-4d76-9cf3-41462615242b"],
Cell[8048, 252, 294, 8, 32, "Output",ExpressionUUID->"2492119a-1042-4e69-aff3-4aa31bd0a7c8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8379, 265, 489, 10, 67, "Input",ExpressionUUID->"736ce504-b69e-491c-a4ce-ac9914711eeb"],
Cell[8871, 277, 1205, 37, 89, "Output",ExpressionUUID->"21c7eee9-3464-4c8e-a480-fd8d80e33d7c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10113, 319, 215, 3, 28, "Input",ExpressionUUID->"e3547a66-2f34-4bfc-b0fa-246be2cb5bb0"],
Cell[10331, 324, 1562, 48, 83, "Output",ExpressionUUID->"e90052a1-3801-494e-b98e-fdd5c74ae45a"]
}, Open  ]]
}
]
*)

